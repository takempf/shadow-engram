---
// src/pages/index.astro
import { db, Contact } from 'astro:db'; // slugify import removed

const contacts = await db.select().from(Contact).all(); // Assuming .all() to fetch all contacts
---
<h1>My Contacts</h1>
<ul>
  {contacts.map(contact => ( // Simplified map, no need for explicit return block if slug generation is removed
    <li>
      {/* Ensure contact.slug is available. If not, link might be broken. */}
      <strong><a href={`/contacts/${contact.slug}`}>{contact.name}</a></strong><br/>
      Email: {contact.email}<br/>
      {contact.phone && `Phone: ${contact.phone}`}
      <a href={`/edit-contact/${contact.id}`}>Edit</a>
      <form method="POST" action={`/delete-contact/${contact.id}`}>
        <button type="submit">Delete</button>
      </form>
    </li>
  ))}
</ul>
<a href="/add-contact">Add New Contact</a>