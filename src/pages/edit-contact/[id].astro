---
import { db, Contact, eq } from 'astro:db';

const { id } = Astro.params;

if (Astro.request.method === 'POST') {
  const formData = await Astro.request.formData();
  const name = formData.get('name') as string;
  const email = formData.get('email') as string;
  const phone = formData.get('phone') as string;

  await db.update(Contact).set({ name, email, phone }).where(eq(Contact.id, Number(id)));
  return Astro.redirect('/');
}

const contact = await db.select().from(Contact).where(eq(Contact.id, Number(id))).get();
---
<form method="POST">
  <label for="name">Name:</label>
  <input type="text" id="name" name="name" value={contact.name} required />

  <label for="email">Email:</label>
  <input type="email" id="email" name="email" value={contact.email} required />

  <label for="phone">Phone:</label>
  <input type="tel" id="phone" name="phone" value={contact.phone || ''} />

  <button type="submit">Update Contact</button>
</form>